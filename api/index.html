<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0,viewport-fit=cover">
    <title>中转</title>
</head>
<body>
    <div id="tips" style="font-size:25px;text-align: center;line-height: 50px;"></div>
    <script>
    var url = document.location.toString();
    var urlParmStr = url.slice(url.indexOf('=')+1);
    // 解码URL参数
    urlParmStr = decodeURIComponent(urlParmStr);
    var ua = navigator.userAgent.toLowerCase();
    var isQQ = ua.indexOf('qq') != -1;
    var isWeixin = ua.indexOf('micromessenger') != -1;
    var isAndroid = ua.indexOf('android') != -1;
    var isIos = (ua.indexOf('iphone') != -1) || (ua.indexOf('ipad') != -1);

    var notice_openBrowser = "<h2>如果未能自动跳转，请点击右上角，通过浏览器打开本页面。</h2><br />链接地址：<b style=\"color:red\">" + urlParmStr + "</b>";

    // 尝试直连打开的函数
    function tryDirectOpen() {
        // 自动尝试跳转
        setTimeout(function() {
            try {
                // 对于iOS设备
                if (isIos) {
                    // 尝试使用window.open进行跳转
                    window.open(urlParmStr, '_blank');
                } 
                // 对于Android设备
                else if (isAndroid) {
                    // 尝试使用intent协议
                    var intentUrl = 'intent://' + urlParmStr.replace(/^https?:\/\//, '') + '#Intent;scheme=' + (urlParmStr.indexOf('https') === 0 ? 'https' : 'http') + ';package=com.android.browser;end';
                    window.location.href = intentUrl;
                } 
                // 其他设备
                else {
                    window.location.href = urlParmStr;
                }
            } catch (e) {
                console.log('跳转失败，显示备用提示', e);
                document.getElementById("tips").innerHTML=notice_openBrowser;
            }
        }, 1000);
    }

    // 判断是不是在微信客户端或QQ客户端打开
    if(isWeixin || isQQ) {
        // 显示提示，但同时尝试自动跳转
        document.getElementById("tips").innerHTML=notice_openBrowser;
        // 尝试直连打开
        tryDirectOpen();
    } else {
        // 不是微信或QQ客户端，直接跳转
        if (urlParmStr == url){
            urlParmStr = "https://www.yiove.com";
        }
        console.log(urlParmStr);
        location.href=urlParmStr;
    }
</script>
    <script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script><script>LA.init({id:"K8YSQIj3WDtj9gG6",ck:"K8YSQIj3WDtj9gG6"})</script>
</body>
</html>
